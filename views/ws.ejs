<% include header %>
        <div id="content-form">
          <div class="row-fluid">
              <div class="accordion span12" id="pane-file-select">
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#pane-file-select" href="#collapseFive">
                      <i id="iFive" class="icon-chevron-right"></i> <%= __("cURL translated request") %>
                    </a>
                  </div>
                  <div id="collapseFive" class="accordion-body collapse" toggle-chevron="#iFive">
                    <div class="accordion-inner">
                      <% if (user && user.group == 'admin') { %>
                      <div class="alert"><strong><%= __("Warning") %></strong> : <%= __("it's not advisable to use your administrator account in your automation scripts.") %></div>
                      <% } %>
                      <p><%= __("Copy/paste the following code to send the request with cURL.") %></p>
                      <p><%= __("Change the files path if they are not in the current directory.") %>
                      <br/><%- __("You might need to add options such as %s or %s depending to your environment.", '<code>--proxy</code>', '<code>--no-buffer</code>') %></p>
                      <textarea class="code" id="curl-request"></textarea>
                    </div>
                  </div>
                </div>
              </div>
          </div>
          <div class="row-fluid">
            <form id="form" class="form-horizontal span6" enctype="multipart/form-data">
              <div class="accordion" id="pane-file-select">
                <div class="accordion-group ninja">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#pane-file-select" href="#collapseOne">
                      <i id="iOne" class="icon-chevron-right"> <%= __("Process server side files") %></i>
                    </a>
                  </div>
                  <div id="collapseOne" class="accordion-body collapse" toggle-chevron="#iOne">
                    <div id="local-files" class="accordion-inner">

                    </div>
                  </div>
                </div>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#pane-file-select" href="#collapseTwo">
                      <i id="iTwo" class="icon-chevron-down"></i> <%= __("Process your log files") %>
                    </a>
                  </div>
                  <div id="collapseTwo" class="accordion-body collapse in" toggle-chevron="#iTwo">
                    <div class="accordion-inner">
                      <div id="classic-inputs">
                        <div class="single-input">
                          <button class="btn btn-danger btn-mini file-remove-button ninja" title="remove"><i class="icon-remove icon-white"></i></button>
                          <input class='file-input' type="file" name="file" multiple/>
                        </div>
                      </div>
                      <div id="dropbox"><%= __("Drop your files here") %></div>
                    </div>
                  </div>
                </div>
              </div>
            </form> <!-- form -->
            <div class="accordion form-horizontal span6" id="pane-options">
              <div class="accordion-group">
                <div class="accordion-heading">
                  <a class="accordion-toggle" data-toggle="collapse" href="#collapseThree">
                    <i id="iThree" class="icon-chevron-right"></i> <%= __("Settings") %>
                  </a>
                </div>
                <div id="collapseThree" class="accordion-body collapse in" toggle-chevron="#iThree">
                  <div id="advanced-options" class="accordion-inner">
                    <div class="control-group">
                      <label class="control-label" for="advanced-options-predefined">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Predefined settings") %>"><%= __("Predefined settings") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <select id="advanced-options-predefined" name="advanced-options-predefined">
                          <option value="" selected><%= __("None") %></option>
                        </select>
                      </div>
                    </div>
                     <div class="control-group">
                      <label class="control-label" for="input-log-type">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("The platform that generated the logs.") %>"><%= __("Log type") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <select id="input-log-type" name="input-log-type">
                          <option value="" selected><%= __("Auto") %></option>
                          <option value="ezproxy">EZproxy</option>
                          <option value="apache">Apache</option>
                          <option value="squid">Squid</option>
                        </select>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="input-log-format">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Format of log lines.") %> <%= __("For more information, consult 'Formats de logs' in the documentation.") %>"><%= __("Log format") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <textarea id="input-log-format" name="input-log-format" row="1" disabled></textarea>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="input-result-format">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Result file format.") %>"><%= __("Result format") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <select id="input-result-format" name="input-result-format">
                          <option value="text/csv" selected>CSV</option>
                          <option value="text/tab-separated-values">TSV</option>
                          <option value="application/json">JSON</option>
                        </select>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="input-traces">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Verbosity of traces, from the less verbose Error to the more verbose Silly.") %>"><%= __("System traces") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <select id="input-traces" name="input-traces">
                          <option value="error">Error</option>
                          <option value="warn">Warn</option>
                          <option value="info" selected>Info</option>
                          <option value="verbose">Verbose</option>
                          <option value="silly">Silly</option>
                        </select>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="input-output-fields">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Fields (headers) to add/remove in the result file.") %>"><%= __("Output fields") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <input id="input-output-fields" placeholder="Ex: -host,-login,+datetime" type="text" name="input-output-fields"/>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="input-request-charset">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Character set used in the files to be processed.") %>"><%= __("Input encoding") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <select id="input-request-charset" name="input-request-charset">
                          <option value="utf-8">UTF-8</option>
                          <option value="iso-8859-1">ISO-8859-1</option>
                        </select>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="input-response-charset">
                        <a class="notALink" data-toggle="tooltip" title="<%= __("Character set used for output data.") %>"><%= __("Output encoding") %> <i class="icon-question-sign"></i></a>
                      </label>
                      <div class="controls">
                        <select id="input-response-charset" name="input-response-charset">
                          <option value="utf-8">UTF-8</option>
                          <option value="iso-8859-1">ISO-8859-1</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="accordion-group">
                <div class="accordion-heading">
                  <a class="accordion-toggle" data-toggle="collapse" href="#collapseFour">
                    <i id="iFour" class="icon-chevron-right"></i> <%= __("Users field") %>
                  </a>
                </div>
                <div id="collapseFour" class="accordion-body collapse" toggle-chevron="#iFour">
                  <div id="user-fields" class="accordion-inner">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="nofile-warn" class="alert alert-warning ninja"><%= __("You must select one file at least") %></div>
          <div id="big-warn" class="alert alert-warning ninja"><%= __("Selected files are large, the process could be long.") %></div>
          <div class="text-center">
            <input type="submit" class="btn" value="<%= __("Process") %>" id="submit" />
            <button class="btn" id="clearCookies"><%= __("Clear cookies") %></button>
          </div>
        </div><!-- form-content -->
        <div id="content-result" class="ninja">
          <div id="process-info" class="texte-center alert alert-info">
            <%= __("Your logs are being processed") %> <%= __("You can already start downloading result.") %>
          </div>
          <div id="process-success" class="texte-center alert alert-success ninja">
            <%= __("Your logs was successfully processed") %>
          </div>
          <div class="alert alert-error text-center ninja">
            <%= __("Error") %> : <span id="error"></span>
          </div>
          <div class="progress progress-striped active">
            <div class="bar" style="width: 0%;">0%</div>
          </div>
          <div id="process-btns" class="text-center">
            <a href="" target="_blank" id="get-btn" class="btn btn-primary btn-large"><%- __("Download result as %s", '<span id="result-format"></span>') %></a>
            <a href="/form" id="cancel-btn" class="btn"><%= __("Cancel") %></a>
          </div>
          <div class="row-fluid">
            <div class="span6">
              <div id="submitted-files">
                <fieldset>
                  <legend><%= __("Processed files") %></legend>
                  <ul></ul>
                </fieldset>
              </div>
              <div id="post-trait-comment">
                <fieldset>
                  <legend><%= __("Exploitation of results") %></legend>
                  <ul><a href="https://github.com/ezpaarse-project/ezpaarse/blob/master/misc/windows/ezPAARSERenderV1.1.xlsm?raw=true" target="_blank">
                    <%= __("Use an Excel rendering file") %></a>
                  </ul>
                  <ul><a href="http://analogist.couperin.org/ezpaarse/doc/usage#visualiser-les-resultats-avec-excel" target="_blank">
                    <%= __("Help for result exploitation using Excel") %></a>
                  </ul>
                </fieldset>
              </div>
            </div>
            <div id="report" class="span6">
              <fieldset>
                <legend><%= __("Process status") %></legend>
                <table class="table table-bordered table-hover">
                  <tr><td><%= __("Input lines") %></td><td id="nb-lines-input" class="result-value"></td></tr>
                  <tr><td><%= __("Generated ECs") %></td><td id="nb-ecs" class="result-value"></td></tr>
                  <tr><td><%= __("Recognized platforms") %></td><td id="platforms" class="result-value"></td></tr>
                  <tr><td>PDF</td><td id="mime-PDF" class="result-value"></td></tr>
                  <tr><td>HTML</td><td id="mime-HTML" class="result-value"></td></tr>
                  <tr>
                    <td>
                      <a class="notALink" data-toggle="tooltip" title="<%= __("The number of rejected lines for one hundred input lines.") %> <%= __("Ignored lines (jpg, js, css...) are not taken into account in this calculation.") %>"><%= __("Filtering rate") %> <i class="icon-question-sign"></i></a>
                    </td>
                    <td id="rejection-rate" class="result-value"></td></tr>
                  <tr><td><%= __("Process time") %></td><td id="job-duration" class="result-value"></td></tr>
                  <tr><td><%= __("Process speed") %></td><td id="process-speed" class="result-value"></td></tr>
                </table>
              </fieldset>
              <fieldset>
                <legend><%= __("Ignored log lines") %></legend>
                <table class="table table-bordered table-hover">
                  <tr>
                    <td>
                      <a class="notALink" data-toggle="tooltip" title="<%= __("Number of irrelevant requests.") %> <%= __("It's mainly downloads of images, css or web script not directly related to a ressource.") %> <%= __("In a raw log file, this number is often high.") %>"><%= __("Ignored lines") %> <i class="icon-question-sign"></i></a>
                    </td>
                    <td id="nb-lines-ignored" class="result-value"></td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-duplicate-ecs" target="_blank" data-toggle="tooltip" title="<%= __("Number of consutations ignored because they were detected as double clicks.") %>"><%= __("Filtered duplicates") %> <i class="icon-question-sign"></i></a></td><td id="nb-lines-duplicate-ecs" class="result-value"></td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-unordered-ecs" target="_blank" data-toggle="tooltip" title="<%= __("Lines ignored due to bad chronological order.") %>"><%= __("Time anomalies") %> <i class="icon-question-sign"></i></a></td><td id="nb-lines-unordered-ecs" class="result-value"></td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-ignored-domains" target="_blank"><%= __("Ignored domains") %></a></td>
                    <td class="result-value">
                      <a class="link-lines-ignored-domains" target="_blank">
                        <span id="nb-lines-ignored-domains"></span>
                      </a></td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-unknown-domains" target="_blank"><%= __("Unknown domains") %></a></td>
                    <td class="result-value">
                      <a class="link-lines-unknown-domains" target="_blank">
                        <span id="nb-lines-unknown-domains"></span>
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-unknown-format" target="_blank"><%= __("Unknown formats") %></a></td>
                    <td class="result-value">
                      <a class="link-lines-unknown-format" target="_blank">
                        <span id="nb-lines-unknown-format"></span>
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-unqualified-ecs" target="_blank"><%= __("Unqualified ECs") %></a></td>
                    <td class="result-value">
                      <a class="link-lines-unqualified-ecs" target="_blank">
                        <span id="nb-lines-unqualified-ecs"></span>
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <td><a class="link-lines-pkb-miss-ecs" target="_blank"><%= __("Missing PKBs") %></a></td>
                    <td class="result-value">
                      <a class="link-lines-pkb-miss-ecs" target="_blank">
                        <span id="nb-lines-pkb-miss-ecs"></span>
                      </a>
                    </td>
                  </tr>
                </table>
              </fieldset>
            </div>

          <div id="result-btns" class="text-center">
            <a target="_blank" id="report-btn" class="btn"><%= __("Detailed report") %></a>
            <a target="_blank" id="traces-btn" class="btn"><%= __("System traces") %></a>
            <a href="/form" id="reset-btn" class="btn ninja"><%= __("New process") %></a>
          </div>
        </div><!-- content-result -->
        </div><!-- content-form (todo: bad indentation ...) -->

        <script type="text/html" id="user-field-template">
        <div class="user-field">
          <div class="control-group">
            <label class="control-label" for="input-user-field-src">
              <a class="notALink" data-toggle="tooltip" title="<%= __("Name of the field containing the information to be extracted.") %>"><%= __("Source field") %> <i class="icon-question-sign"></i></a>
            </label>
            <div class="controls">
              <input class="input-user-field-src" type="text" name="input-user-field-src"/>
            </div>
          </div>
          <div class="control-group">
            <label class="control-label" for="input-user-field-sep">
              <a class="notALink" data-toggle="tooltip" title="<%= __("Character between the values ​​of the source field (use the word 'space' if the separator is a space)") %>"><%= __("Separator") %> <i class="icon-question-sign"></i></a>
            </label>
            <div class="controls">
              <input class="input-user-field-sep" placeholder="Ex: space + , ;" type="text" name="input-user-field-sep"/>
            </div>
          </div>
          <div class="control-group">
            <label class="control-label" for="input-user-field-dest">
              <a class="notALink" data-toggle="tooltip" title="<%= __("Fields where extracted values will be stored.") %> <%= __("Values in line with a regular expression are added to field.") %>"><%= __("Destination fields") %> <i class="icon-question-sign"></i></a>
            </label>
            <div class="controls">
              <div class="user-field-dest row-fluid">
                <div class="dest">
                  <input class="span4 input-user-field-dest-name" type="text" name="input-user-field-dest-name" placeholder="<%= __("Name") %>"/>
                  <input class="span8 input-user-field-dest-regexp" type="text" name="input-user-field-dest-regexp" placeholder="<%= __("Regular expression") %>"/>
                </div>
              </div>
            </div>
          </div>
          <div class="control-group">
            <label class="control-label" for="input-user-field-residual">
              <a class="notALink" data-toggle="tooltip" title="<%= __("(Optional) Field which will receive values that don't match any regular expression.") %>"><%= __("Residuals field") %> <i class="icon-question-sign"></i></a>
            </label>
            <div class="controls">
              <input class="input-user-field-residual" type="text" name="input-user-field-residual"/>
            </div>
          </div>
        </div>
        </script>
        <script type="text/html" id="dest-template">
        <div class="dest">
          <input class="span4 input-user-field-dest-name" type="text" name="input-user-field-dest-name" placeholder="<%= __("Name") %>"/>
          <input class="span8 input-user-field-dest-regexp" type="text" name="input-user-field-dest-regexp" placeholder="<%= __("Regular expression") %>"/>
        </div>
        </script>

        <div id="navigator-alert" class="text-center ninja">
          <h2>
            <%= __("Your browser is too old to work with ezPAARSE.") %>
          </h2>
          <h2>
            <%= __("We recommend that you use :") %>
          </h2>
          <div class="span2"></div>
          <div class="row-fluid">
            <div class="span3">
              <a href="http://www.google.fr/intl/fr/chrome/browser/">
                <h2>Chrome</h2>
                <img src="/img/chrome.jpg" alt="logo chrome">
              </a>
            </div>
            <div class="span1">
              <h2><%= __("or") %></h2>
            </div>
            <div class="span3">
              <a href="http://www.mozilla.org/fr/firefox/new/">
                <h2>Firefox</h2>
                <img src="/img/firefox.jpg" alt="logo firefox">
              </a>
            </div>
            <div class="span3"></div>
          </div>
        </div> <!-- navigator-alert -->

<% include footer %>